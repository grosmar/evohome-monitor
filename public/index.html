
<!doctype html>
<html>

<head>
	<title>Line Chart Multiple Axes</title>
	<script src="https://www.chartjs.org/dist/2.9.4/Chart.min.js"></script>
	<script src="https://www.chartjs.org/samples/latest/utils.js"></script>
	<style>
	canvas {
		-moz-user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}
	</style>
</head>

<body>
	<div style="width:90%;">
		<canvas id="canvas"></canvas>
	</div>
	<script>
		function loadJSON(callback) {   
			var xobj = new XMLHttpRequest();
				xobj.overrideMimeType("application/json");
			xobj.open('GET', 'data.json', true); // Replace 'my_data' with the path to your file
			xobj.onreadystatechange = function () {
				if (xobj.readyState == 4 && xobj.status == "200") {
					// Required use of an anonymous callback as .open will NOT return a value but simply returns undefined in asynchronous mode
					callback(xobj.responseText);
				}
			};
			xobj.send(null);  
		}

		function getFormattedDate( timestamp ) {
			var date = new Date();
			date.setTime(timestamp);

			var month = date.getMonth() + 1;
			var day = date.getDate();
			var hour = date.getHours();
			var min = date.getMinutes();
			var sec = date.getSeconds();

			month = (month < 10 ? "0" : "") + month;
			day = (day < 10 ? "0" : "") + day;
			hour = (hour < 10 ? "0" : "") + hour;
			min = (min < 10 ? "0" : "") + min;
			sec = (sec < 10 ? "0" : "") + sec;

			var str = date.getFullYear() + "-" + month + "-" + day + " " +  hour + ":" + min;

			/*alert(str);*/

			return str;
		}


		

		var lineChartData = {
			labels: [],
			datasets: [{
				label: 'Cellar target',
				borderColor: "lightBlue",
				backgroundColor: "lightBlue",
				fill: false,
				data: []
			},
			{
				label: 'Cellar',
				borderColor: "blue",
				backgroundColor: "blue",
				fill: false,
				data: []
			}
			, {
				label: 'Ground target',
				borderColor: "pink",
				backgroundColor: "pink",
				fill: false,
				data: []
			},
			{
				label: 'Ground',
				borderColor: "red",
				backgroundColor: "red",
				fill: false,
				data: []
			},
			{
				label: 'First target',
				borderColor: "lightGreen",
				backgroundColor: "lightGreen",
				fill: false,
				data: []
			},
			{
				label: 'First',
				borderColor: "green",
				backgroundColor: "green",
				fill: false,
				data: []
			}]
		};

		window.onload = function() {

			loadJSON(function(response) {
    		var data = JSON.parse(response);

			lineChartData.labels = data.map((v) => { return getFormattedDate(v.timestamp) });

			lineChartData.datasets[0].data = data.map((v) => { return v.cellar.target });
			lineChartData.datasets[1].data = data.map((v) => { return v.cellar.temp });
			lineChartData.datasets[2].data = data.map((v) => { return v.ground.target });
			lineChartData.datasets[3].data = data.map((v) => { return v.ground.temp });
			lineChartData.datasets[4].data = data.map((v) => { return v.first.target });
			lineChartData.datasets[5].data = data.map((v) => { return v.first.temp });
			console.log(data);
				
			var ctx = document.getElementById('canvas').getContext('2d');
			window.myLine = Chart.Line(ctx, {
				data: lineChartData,
				options: {
					responsive: true,
					title: {
						display: true,
						text: 'Chart.js Line Chart'
					},
					tooltips: {
						mode: 'index',
						intersect: false,
					},
					hover: {
						mode: 'nearest',
						intersect: true
					},
					scales: {
						xAxes: [{
							display: true,
							scaleLabel: {
								display: true,
								labelString: 'Month'
							}
						}],
						yAxes: [{
							display: true,
							scaleLabel: {
								display: true,
								labelString: 'Value'
							},
							ticks: {
								min: 5,
								max: 30
							}
						}]
					}
				}
			});

		});
		
	};


	</script>
</body>

</html>
